"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _userEvent = _interopRequireDefault(require("@testing-library/user-event"));

var _Paginator = _interopRequireDefault(require("./Paginator"));

// Mocking DOMRect for Radix Primitive Popover
global.globalThis = global;

global.ResizeObserver = /*#__PURE__*/function () {
  function ResizeObserver(cb) {
    (0, _classCallCheck2["default"])(this, ResizeObserver);
    this.cb = cb;
  }

  (0, _createClass2["default"])(ResizeObserver, [{
    key: "observe",
    value: function observe() {
      this.cb([{
        borderBoxSize: {
          inlineSize: 0,
          blockSize: 0
        }
      }]);
    }
  }, {
    key: "unobserve",
    value: function unobserve() {}
  }]);
  return ResizeObserver;
}();

global.DOMRect = {
  fromRect: function fromRect() {
    return {
      top: 0,
      left: 0,
      bottom: 0,
      right: 0,
      width: 0,
      height: 0
    };
  }
};
describe("Paginator component tests", function () {
  test("Paginator renders with default values", function () {
    var _render = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], null)),
        getByText = _render.getByText;

    expect(getByText("1 to 1 of 1")).toBeTruthy();
    expect(getByText("Page: 1 of 1")).toBeTruthy();
  });
  test("Paginator renders with currentPage", function () {
    var _render2 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 2
    })),
        getByText = _render2.getByText;

    expect(getByText("Page: 2 of 1")).toBeTruthy();
  });
  test("Paginator renders with itemsPerPageOptions", function () {
    var _render3 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 1,
      itemsPerPage: 10,
      itemsPerPageOptions: [10, 15],
      totalItems: 20
    })),
        getByText = _render3.getByText;

    expect(getByText("Items per page")).toBeTruthy();
  });
  test("Paginator renders with itemsPerPageOptions", function () {
    var _render4 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getByText = _render4.getByText;

    expect(getByText("1 to 10 of 20")).toBeTruthy();
    expect(getByText("Page: 1 of 2")).toBeTruthy();
  });
  test("Paginator renders with totalItems", function () {
    var _render5 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      totalItems: 20
    })),
        getByText = _render5.getByText;

    expect(getByText("1 to 5 of 20")).toBeTruthy();
    expect(getByText("Page: 1 of 4")).toBeTruthy();
  });
  test("Paginator renders with correct text in second page", function () {
    var _render6 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 2,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getByText = _render6.getByText;

    expect(getByText("11 to 20 of 20")).toBeTruthy();
    expect(getByText("Page: 2 of 2")).toBeTruthy();
  });
  test("Paginator renders goToPage select", function () {
    var _render7 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 2,
      showGoToPage: true,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getByText = _render7.getByText;

    expect(getByText("Go to page:")).toBeTruthy();
  });
  test("Paginator goToPage call correct function", function () {
    var onClick = jest.fn();

    window.HTMLElement.prototype.scrollIntoView = function () {};

    window.HTMLElement.prototype.scrollTo = function () {};

    var _render8 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 27,
      showGoToPage: true,
      onPageChange: onClick
    })),
        getByText = _render8.getByText,
        getAllByRole = _render8.getAllByRole,
        getByRole = _render8.getByRole;

    var goToPageSelect = getAllByRole("combobox")[0];
    (0, _react2.act)(function () {
      _userEvent["default"].click(goToPageSelect);
    });
    var goToPageOption = getByText("2");
    (0, _react2.act)(function () {
      _userEvent["default"].click(goToPageOption);
    });
    expect(onClick).toHaveBeenCalledWith(2);
  });
  test("Call correct goToPageFunction", function () {
    var onClick = jest.fn();

    var _render9 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render9.getAllByRole;

    var nextButton = getAllByRole("button")[2];

    _userEvent["default"].click(nextButton);

    expect(onClick).toHaveBeenCalled();
  });
  test("Call correct itemsPerPageFunction", function () {
    var onClick = jest.fn();

    window.HTMLElement.prototype.scrollIntoView = function () {};

    window.HTMLElement.prototype.scrollTo = function () {};

    var _render10 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      currentPage: 1,
      itemsPerPage: 10,
      itemsPerPageOptions: [10, 15],
      itemsPerPageFunction: onClick,
      totalItems: 20
    })),
        getAllByText = _render10.getAllByText,
        getByText = _render10.getByText;

    var select = getAllByText("10")[0];
    (0, _react2.act)(function () {
      _userEvent["default"].click(select);
    });
    var itemPerPageOption = getByText("15");
    (0, _react2.act)(function () {
      _userEvent["default"].click(itemPerPageOption);
    });
    expect(onClick).toHaveBeenCalledWith(15);
  });
  test("Next button is disable in last page", function () {
    var onClick = jest.fn();

    var _render11 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 2,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render11.getAllByRole;

    var nextButton = getAllByRole("button")[2];
    expect(nextButton.hasAttribute("disabled")).toBeTruthy();

    _userEvent["default"].click(nextButton);

    expect(onClick).toHaveBeenCalledTimes(0);
  });
  test("Last button is disable in last page", function () {
    var onClick = jest.fn();

    var _render12 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 2,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render12.getAllByRole;

    var lastButton = getAllByRole("button")[3];
    expect(lastButton.hasAttribute("disabled")).toBeTruthy();

    _userEvent["default"].click(lastButton);

    expect(onClick).toHaveBeenCalledTimes(0);
  });
  test("First button is disable in first page", function () {
    var onClick = jest.fn();

    var _render13 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render13.getAllByRole;

    var lastButton = getAllByRole("button")[0];
    expect(lastButton.hasAttribute("disabled")).toBeTruthy();

    _userEvent["default"].click(lastButton);

    expect(onClick).toHaveBeenCalledTimes(0);
  });
  test("Previous button is disable in first page", function () {
    var onClick = jest.fn();

    var _render14 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render14.getAllByRole;

    var lastButton = getAllByRole("button")[1];
    expect(lastButton.hasAttribute("disabled")).toBeTruthy();

    _userEvent["default"].click(lastButton);

    expect(onClick).toHaveBeenCalledTimes(0);
  });
  test("Last and next buttons are disable in last page", function () {
    var onClick = jest.fn();

    var _render15 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 2,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render15.getAllByRole;

    var firstButton = getAllByRole("button")[0];
    var prevButton = getAllByRole("button")[1];
    var nextButton = getAllByRole("button")[2];
    var lastButton = getAllByRole("button")[3];
    expect(firstButton.hasAttribute("disabled")).toBeFalsy();
    expect(prevButton.hasAttribute("disabled")).toBeFalsy();
    expect(nextButton.hasAttribute("disabled")).toBeTruthy();
    expect(lastButton.hasAttribute("disabled")).toBeTruthy();
  });
  test("First and previous buttons are disable in first page", function () {
    var onClick = jest.fn();

    var _render16 = (0, _react2.render)( /*#__PURE__*/_react["default"].createElement(_Paginator["default"], {
      onPageChange: onClick,
      currentPage: 1,
      itemsPerPage: 10,
      totalItems: 20
    })),
        getAllByRole = _render16.getAllByRole;

    var firstButton = getAllByRole("button")[0];
    var prevButton = getAllByRole("button")[1];
    var nextButton = getAllByRole("button")[2];
    var lastButton = getAllByRole("button")[3];
    expect(firstButton.hasAttribute("disabled")).toBeTruthy();
    expect(prevButton.hasAttribute("disabled")).toBeTruthy();
    expect(nextButton.hasAttribute("disabled")).toBeFalsy();
    expect(lastButton.hasAttribute("disabled")).toBeFalsy();
  });
});